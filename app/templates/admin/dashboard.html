{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–µ–æ</h2>

    {% if current_user.is_admin %}
    <div class="mb-3">
        <a href="{{ url_for('main.upload_video') }}" class="btn btn-success">‚¨Ü –î–æ–±–∞–≤–∏—Ç—å –≤–∏–¥–µ–æ</a>
    </div>
    {% endif %}

    <h3>–°–ø–∏—Å–æ–∫ –≤–∏–¥–µ–æ</h3>

    {% if pagination.items %}
    <table class="table table-bordered table-striped align-middle">
        <thead class="table-light">
            <tr>
                <th>ID</th>
                <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                <th>–ê–≤—Ç–æ—Ä</th>
                <th>–î–∞—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏</th>
                {% if current_user.is_admin %}
                    <th style="width: 200px;">–î–µ–π—Å—Ç–≤–∏—è</th>
                {% endif %}
            </tr>
        </thead>
        <tbody>
            {% for video in pagination.items %}
            <tr>
                <td>{{ video.id }}</td>
                <td>{{ video.title }}</td>
                <td>{{ video.category.name if video.category else '-' }}</td>
                <td>{{ video.user.username if video.user else '‚Äî' }}</td>
                <td>{{ video.created_at.strftime('%Y-%m-%d %H:%M') }}</td>

                {% if current_user.is_admin %}
                <td>
                    <div class="d-flex gap-2">
                        <!-- –ö–Ω–æ–ø–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
                        <a href="{{ url_for('main.admin_edit_video', video_id=video.id) }}" 
                           class="btn btn-warning btn-sm">
                            ‚úè –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                        </a>

                        <!-- –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è -->
                        <form action="{{ url_for('main.admin_delete_video', video_id=video.id) }}" 
                              method="POST" style="display:inline;">
                            <button type="submit" class="btn btn-danger btn-sm"
                                    onclick="return confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ –≤–∏–¥–µ–æ?');">
                                üóë –£–¥–∞–ª–∏—Ç—å
                            </button>
                        </form>
                    </div>
                </td>
                {% endif %}
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
    <nav aria-label="Page navigation">
        <ul class="pagination">
            {% if pagination.has_prev %}
                <li class="page-item">
                    <a class="page-link" href="{{ url_for('main.admin_videos', page=pagination.prev_num) }}">–ù–∞–∑–∞–¥</a>
                </li>
            {% endif %}

            {% for page_num in pagination.iter_pages() %}
                {% if page_num %}
                    <li class="page-item {% if page_num == pagination.page %}active{% endif %}">
                        <a class="page-link" href="{{ url_for('main.admin_videos', page=page_num) }}">{{ page_num }}</a>
                    </li>
                {% else %}
                    <li class="page-item disabled"><span class="page-link">‚Ä¶</span></li>
                {% endif %}
            {% endfor %}

            {% if pagination.has_next %}
                <li class="page-item">
                    <a class="page-link" href="{{ url_for('main.admin_videos', page=pagination.next_num) }}">–í–ø–µ—Ä—ë–¥</a>
                </li>
            {% endif %}
        </ul>
    </nav>
    {% else %}
        <p>–í–∏–¥–µ–æ –ø–æ–∫–∞ –Ω–µ—Ç.</p>
    {% endif %}
</div>
{% endblock %}
