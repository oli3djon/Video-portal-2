<!doctype html>
<html lang="ru" data-bs-theme="auto">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{{ title or "–í–∞—à –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –≤–∏–¥–µ–æ—Ü–µ–Ω—Ç—Ä" }}</title>

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- –ò–∫–æ–Ω–∫–∏ -->
  <link rel="icon" href="{{ url_for('static', filename='images/logo32.ico') }}" type="image/x-icon">


  <!-- –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Å—Ç–∏–ª–∏ -->
  <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
</head>
<body class="d-flex flex-column min-vh-100 bg-gradient">

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg border-bottom bg-body-tertiary sticky-top glassy-nav">
    <div class="container">
      <a class="navbar-brand fw-semibold" href="{{ url_for('main.index') }}">
        <img src="{{ url_for('static', filename='images/servoluxca.png') }}" alt="Logo" height="24">
      </a>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div id="nav" class="collapse navbar-collapse">
        <ul class="navbar-nav me-auto">
          <li class="nav-item"><a class="nav-link" href="{{ url_for('main.index') }}">–ì–õ–ê–í–ù–ê–Ø</a></li>
          <li class="nav-item"><a class="nav-link" href="{{ url_for('main.about') }}">–û –ü–†–û–ï–ö–¢–ï</a></li> 
           <li class="nav-item"><a class="nav-link" href="{{ url_for('main.contacts') }}">–ö–û–ù–¢–ê–ö–¢–´</a></li>        

          {% if current_user.is_authenticated %}
            <li class="nav-item"><a class="nav-link" href="{{ url_for('main.upload_video') }}">üé¨–î–û–ë–ê–í–ò–¢ –í–ò–î–ï–û</a></li>
            
            {% if current_user.is_admin %}
              <li class="nav-item"><a class="nav-link" href="{{ url_for('main.admin_videos') }}">üé¨–£–ü–†–ê–í–õ–ï–ù–ò–ï –í–ò–î–ï–û</a></li>
              <li class="nav-item"><a class="nav-link" href="{{ url_for('main.admin_categories') }}">üìÇ–£–ü–†–ê–í–õ–ï–ù–ò–ï –ö–ê–¢–ï–ì–û–†–ò–Ø–ú–ò</a></li>
            {% endif %}
          {% endif %}
        </ul>

        <!-- üë§ –í—Ö–æ–¥ / –í—ã—Ö–æ–¥ -->
        <ul class="navbar-nav mb-2 mb-lg-0">
          {% if current_user.is_authenticated %}
            <li class="nav-item">
              <span class="nav-link">–ü–†–ò–í–ï–¢, {{ current_user.username }}</span>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('auth.logout') }}">–í–´–ô–¢–ò</a>
            </li>
          {% else %}
            <li class="nav-item">
              <a class="btn btn-outline-success btn-sm" href="{{ url_for('auth.login') }}">–í–û–ô–¢–ò</a>
            </li>
          {% endif %}
        </ul>

        <!-- üåô –¢—É–º–±–ª–µ—Ä —Ç–µ–º—ã -->
        <div class="d-flex align-items-center gap-2 ms-3">
          <button class="btn btn-outline-secondary btn-sm" id="themeToggle" title="–¢–µ–º–∞">üåì</button>
        </div>
      </div>
    </div>
  </nav>

  <!-- Flash —Å–æ–æ–±—â–µ–Ω–∏—è -->
  <div class="container mt-3">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 1100;">
          {% for category, message in messages %}
          <div class="toast align-items-center text-bg-{{ category if category in ['success','danger','warning','info'] else 'info' }} show mb-2" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="d-flex">
              <div class="toast-body">{{ message }}</div>
              <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
          </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}
  </div>

  <!-- –ö–æ–Ω—Ç–µ–Ω—Ç -->
  <main class="container py-4 flex-grow-1">
    {% block content %}{% endblock %}
  </main>

  <footer class="border-top py-3 mt-auto">
    <div class="container text-center text-muted small">¬© 2025 {{ config.SITE_NAME if config and config.SITE_NAME else'SERVOLUX CA ¬∑ iT ¬∑ UZBEKISTAN' }}</div>
  </footer>

<!-- –ö–Ω–æ–ø–∫–∞ –Ω–∞–≤–µ—Ä—Ö -->
<button onclick="scrollToTop()" id="backToTop" title="–ù–∞–≤–µ—Ä—Ö">‚Üë</button>

<style>
  /* –ö–Ω–æ–ø–∫–∞ */
  #backToTop {
    display: none; /* —Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
    position: fixed;
    bottom: 30px;
    right: 30px;
    z-index: 99;
    border: none;
    outline: none;
    background-color: #007bff;
    color: white;
    cursor: pointer;
    padding: 12px 18px;
    border-radius: 50%;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
    transition: background 0.3s, transform 0.2s;
  }

  /* –•–æ–≤–µ—Ä-—ç—Ñ—Ñ–µ–∫—Ç */
  #backToTop:hover {
    background-color: #0056b3;
    transform: scale(1.1);
  }

  /* –î–ª—è —Ç—ë–º–Ω–æ–π —Ç–µ–º—ã */
  .dark-theme #backToTop {
    background-color: #238636;
  }

  .dark-theme #backToTop:hover {
    background-color: #1a5e2b;
  }
</style>

<script>
  // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ –≤–Ω–∏–∑
  window.onscroll = function () {
    let btn = document.getElementById("backToTop");
    if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
      btn.style.display = "block";
    } else {
      btn.style.display = "none";
    }
  };

  // –§—É–Ω–∫—Ü–∏—è –ø–ª–∞–≤–Ω–æ–≥–æ —Å–∫—Ä–æ–ª–ª–∞ –Ω–∞–≤–µ—Ä—Ö
  function scrollToTop() {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }
</script>

  <!-- Bootstrap JS –∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
